---
title: "Data Science Project - Summer in Europe"
subtitle: "Collecting Data from the Web using R"
date: "Last edited `r format(Sys.time(), '%d %B %Y')`"
output: html_document
---

<style>
body {
font-family: Calibri
}
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.align = 'center', echo = TRUE, message = FALSE, warning = FALSE)
```

getwd()
setwd(/Users/renatoventocilla")

# Data Science Project
```{r setup, include=FALSE}
library(plotly)
library(giscoR)
library(tidyverse)
library(dplyr)
library(readr)
library(readxl)
library(tibble)
library(naniar)
library(viridis)
library(ggsci)
library(tmap)
library(maps)
library(spData)
library(magick)
library(grid)
library(tmap)
library(ggmap)
library(rgdal)
library(lubridate)

```


```{r setup, include=FALSE}

parks <- read_csv(file = "change-visitors-parks-covid.csv")
spec(parks)

names(parks) <- c('countries', 'iso', 'Days', 'parks')

eurocountries <- c("Austria", "Belgium", "Bulgaria", "Croatia", "Cyprus", "Czechia", "Denmark", "Estonia", "Finland", "France",
                   "Germany", "Greece", "Hungary", "Ireland", "Italy", "Latvia", "Lithuania", "Luxembourg", "Malta", "Netherland",
                   "Poland", "Portugal", "Romania", "Slovakia", "Slovenia", "Spain", "Sweden")

```

```{r setup, include=FALSE}

eu_parks <- parks %>%
  filter(countries %in% eurocountries)

```

```{r setup, include=FALSE}

eu_parks_mean <- eu_parks %>%
  group_by(Days) %>%
  summarize(Visits = mean(parks))

```  

```{r setup, include=FALSE}

freq_parks_visit <- ggplot(eu_parks_mean, aes (x = Days, y = Visits)) + geom_line(size = 1.5, color ="#404788FF") + 
  geom_area(fill = "#20A387FF", alpha = 0.6) +
  scale_y_continuous(limits = c(-40, 175), 
                     breaks = c(-30, 0, 25, 50, 75, 100, 125, 150), name = "Average Change of Visits (in %)") + 
  scale_x_date(limits = as.Date(c("2020-03-01", "2021-09-01")), 
               date_breaks = "3 month", date_minor_breaks = "month", 
               date_labels = "%b (%y)", name = "Month") + theme_minimal() + 
    theme(axis.title.x = element_text(size = 10),
    axis.title.y = element_text(size = 10),
    axis.title.y.right = element_text(color = "#20A387FF", size = 10)) + labs(title = "Frequency of Park Visits in numbers", subtitle = "Change relative to the period before the Pandemic", caption = "Source: Our World in Data")

freq_parks_visit

```

```{r setup, include=FALSE}  

interact_visits <- ggplotly(freq_parks_visit)

interact_visits


ggsave(file = "", width = 9, height = 5)

```


