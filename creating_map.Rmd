---
title: "Mapping Tourism Trends from Eurostat"
author: "Lisa Pramann"
date: "12/5/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Import libraries and source scripts
```{r}

library(tidyverse)
library(sf)
library(sp)
library(tmap)
library(viridis)
library(magick)

#Importing wrangled data-sets
source("98_data-wrangling-scripts/glimpse_eurostat_data.R")
#Get shape-files from Spatial-data 
source("98_data-wrangling-scripts/glimpse_geo_data.R")
```



Create interactive map for percentage change in total number of tourism (total period of the pandemic)
```{r}

data_total_animation <- eurostat_total_percent %>% 
  mutate_at(c(2:22), as.numeric, round, 2) %>% 
  select(-c(`2020-01`, `2020-02`))
  
  
#join with spatial data
tourism_total_02 <- left_join( 
  europe_countries, data_total_animation,
  by = c("NAME_ENGL" = "States" ))

#glimpse(tourism_total_02)

#Manipulating Data set 
tourism_total_02.1<- tourism_total_02 %>%
  pivot_longer(., cols= 6:24, names_to = "year", values_to = "tourist_stays")

europe_animation_02 <- tm_shape(tourism_total_02.1, bbox = europe_region) +
  tm_polygons(
    col = "tourist_stays",
    border.col = "white",
    pal = viridis(10, option = "mako", begin = 0.3, end = 1, direction = 1),
    midpoint = NA,
    border.alpha = 0.5,
    breaks = c(-100, -80,-60, -40, -30, -20, -10, 0, 10, 20),
    title = "Change in % comp. to 2019") +
  tm_legend(legend.position = c("right", "bottom")) +
  tm_layout(title = "Stays at Tourist Accomendations in Europe ",
    title.size = 2.5,
    title.position = c("left", "top"),
    legend.position = c("RIGHT","TOP"),
    legend.text.size = 1.6, 
    legend.title.size = 1.7,
    frame = FALSE) +
  tm_facets(along = "year")

tmap_animation(
  europe_animation_02, filename = "graphs/tourism_total_2020_2021.gif", width = 1700, height = 1500,
  delay = 150
  )

```

