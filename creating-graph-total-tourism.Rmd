---
title: "Plot total tourism Europe"
author: "Lisa Pramann"
date: "12/9/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Load libraries and data sets from separate script 
```{r}
library(tidyverse)
library(hrbrthemes)
library(plotly)
library(viridis)
source("98_data-wrangling-scripts/glimpse_eurostat_data.R")
source("98_data-wrangling-scripts/glimpse_covid_measures_index_europe.R") 

```

Mutating data sets  
```{r}

#glimpse(eurostat_total_percent)

tourism_total_graph <- eurostat_total_percent %>% 
  pivot_longer(., cols= 2:22, names_to = "year", values_to = "tourist_stays_percent") %>% 
  filter(States == "European Union - 27 countries (from 2020)") %>% 
  mutate(Month = lubridate::ym(year)) %>% 
  arrange(Month) 
  
#glimpse(tourism_total_graph)
#glimpse(data_covid_measures)

#Join dataframes and filter Jan/Feb 2020 to only get the pandemic-time-series
tourism_total_graph_02 <- left_join( 
  tourism_total_graph, covid_stats) %>% 
  filter(!year == c("2020-01", "2020-02"))

```

First glimpse at data 
```{r}

p <- tourism_total_graph_02 %>% 
  ggplot(aes(x=Month)) +
  geom_line(aes(y = tourist_stays_percent), color = "#404788FF") +
  geom_line(aes(y = mean_month_measures), color="#20A387FF") +
  scale_y_continuous(limits = c(-100, 100), breaks = c(-100, -75, -50, -25, 0, 25, 50, 75, 100),
    name = "Change (in %) / Covid-Measures (Index 0-100)") +
  scale_x_date(limits = as.Date(c("2020-03-01","2021-09-01")),
              date_breaks = "3 month",
              date_minor_breaks = "month", 
              date_labels = "%b (%y)") +
  xlab("The Pandemic Months (March 2020 - September 2021)") +
   theme_ipsum() +
  theme(
    axis.title.x = element_text(size=10),
    axis.title.y = element_text( size=10),
    axis.title.y.right = element_text(color = "#20A387FF", size=10)
  )

#p

p <- p %>% style(hoverinfo = "y")

ggplotly(p)

```

